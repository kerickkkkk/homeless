(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20e872"],{b06d:function(e,t,c){"use strict";c.r(t);var a=c("5530"),r=(c("99af"),c("7a23")),o={class:"container my-3"},n={class:"table mb-3"},d=Object(r["createVNode"])("thead",null,[Object(r["createVNode"])("tr",null,[Object(r["createVNode"])("th",{width:"100"}," 購買時間 "),Object(r["createVNode"])("th",{width:"100"}," Email "),Object(r["createVNode"])("th",null," 購買款項 "),Object(r["createVNode"])("th",{width:"100"}," 應付金額 "),Object(r["createVNode"])("th",{width:"150"}," 是否付款 "),Object(r["createVNode"])("th",{width:"120"}," 編輯 ")])],-1),l={class:"text-end"},i={class:"form-check form-switch"},s={class:"btn-group btn-group-sm",role:"group","aria-label":"Basic example"},b={key:1},u=Object(r["createVNode"])("td",{class:"text-center",colspan:"100"}," 目前沒有訂單唷!!! ",-1);function O(e,t,c,O,j,p){var h=Object(r["resolveComponent"])("Pagination"),m=Object(r["resolveComponent"])("OrdersModal");return Object(r["openBlock"])(),Object(r["createBlock"])("div",o,[Object(r["createVNode"])("table",n,[d,Object(r["createVNode"])("tbody",null,[j.orders.length>0?(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],{key:0},Object(r["renderList"])(j.orders,(function(t){return Object(r["openBlock"])(),Object(r["createBlock"])("tr",{key:t.id},[Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(null===t||void 0===t?void 0:t.user.email),1),Object(r["createVNode"])("td",null,[Object(r["createVNode"])("ul",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(t.products,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("li",{key:e.id},Object(r["toDisplayString"])("".concat(e.product.title,": ").concat(e.product.price," * ").concat(e.qty," = ").concat(e.final_total)),1)})),128))])]),Object(r["createVNode"])("td",l," NT "+Object(r["toDisplayString"])(e.$filters.currency(t.total)),1),Object(r["createVNode"])("td",null,[Object(r["createVNode"])("div",i,[Object(r["createVNode"])("input",{id:"customSwitch".concat(t.id),checked:t.is_paid,class:"form-check-input",type:"checkbox",onChange:function(e){return p.changePayment(t.id,t)}},null,40,["id","checked","onChange"]),Object(r["createVNode"])("label",{class:["form-check-label",{"text-success":t.is_paid}],for:"customSwitch".concat(t.id)},Object(r["toDisplayString"])(t.is_paid?"已付款":"未付款"),11,["for"])])]),Object(r["createVNode"])("td",null,[Object(r["createVNode"])("div",s,[Object(r["createVNode"])("button",{type:"button",class:"btn btn-outline-primary",onClick:function(e){return p.modalHandler("edit",t.id,Object(a["a"])({},t))}}," 檢視 ",8,["onClick"]),Object(r["createVNode"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(e){return p.modalHandler("delete",t.id)}}," 刪除 ",8,["onClick"])])])])})),128)):(Object(r["openBlock"])(),Object(r["createBlock"])("tr",b,[u]))])]),Object(r["createVNode"])(h,{pagination:j.pagination,onGetItems:p.getOrders},null,8,["pagination","onGetItems"]),Object(r["createVNode"])(m,{ref:"OrdersModal",onChangePayment:p.changePayment,onGetOrders:p.getOrders},null,8,["onChangePayment","onGetOrders"])])}c("c740");var j=c("1799"),p=(c("b0c0"),{ref:"adminEditOrdersModal",class:"modal",tabindex:"-1"}),h={class:"modal-dialog modal-xl"},m={class:"modal-content"},N={class:"modal-header"},V=Object(r["createVNode"])("h5",{class:"modal-title"}," 訂單細節 ",-1),g={class:"modal-body"},f={class:"row"},y={class:"col-md-4"},k=Object(r["createVNode"])("h3",null,"使用者資訊",-1),v={class:"table"},$={key:0},w=Object(r["createVNode"])("th",{width:"80"}," 姓名 ",-1),S=Object(r["createVNode"])("th",null,"Email",-1),B=Object(r["createVNode"])("th",null,"電話",-1),C=Object(r["createVNode"])("th",null,"地址",-1),_={class:"col-md-8"},x=Object(r["createVNode"])("h3",null,"訂單資訊",-1),D={class:"table"},M={key:0},L=Object(r["createVNode"])("th",null,"編號",-1),P=Object(r["createVNode"])("th",{width:"100"}," 下單時間 ",-1),T=Object(r["createVNode"])("th",{width:"100"}," 付款時間 ",-1),E={key:0},G={key:1},F=Object(r["createVNode"])("th",null,"是否付款",-1),H=Object(r["createVNode"])("th",null," 總價 ",-1),I=Object(r["createVNode"])("h3",null,"訂購的商品",-1),q={class:"table"},J={key:0},U={width:"100"},z={width:"100",class:"text-end"},A={class:"d-flex justify-content-end"},K={class:"form-check"},Q={class:"form-check-label",for:"payChecked"},R={class:"modal-footer"},W={ref:"adminDeleteOrderModal",class:"modal",tabindex:"-1"},X={class:"modal-dialog"},Y={class:"modal-content"},Z={class:"modal-header"},ee=Object(r["createVNode"])("h5",{class:"modal-title"}," 刪除訂單 ",-1),te=Object(r["createVNode"])("div",{class:"modal-body"},[Object(r["createVNode"])("p",{class:"h3"},[Object(r["createTextVNode"])(" 是否要"),Object(r["createVNode"])("span",{class:"text-danger"},"刪除"),Object(r["createTextVNode"])("?? ")])],-1),ce={class:"modal-footer"};function ae(e,t,c,a,o,n){return Object(r["openBlock"])(),Object(r["createBlock"])("div",null,[Object(r["createVNode"])("div",p,[Object(r["createVNode"])("div",h,[Object(r["createVNode"])("div",m,[Object(r["createVNode"])("div",N,[V,Object(r["createVNode"])("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[1]||(t[1]=function(e){return n.closeModal("edit")})})]),Object(r["createVNode"])("div",g,[Object(r["createVNode"])("div",f,[Object(r["createVNode"])("div",y,[k,Object(r["createVNode"])("table",v,[o.tempOrder.user?(Object(r["openBlock"])(),Object(r["createBlock"])("tbody",$,[Object(r["createVNode"])("tr",null,[w,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.tempOrder.user.name),1)]),Object(r["createVNode"])("tr",null,[S,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.tempOrder.user.email),1)]),Object(r["createVNode"])("tr",null,[B,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.tempOrder.user.tel),1)]),Object(r["createVNode"])("tr",null,[C,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.tempOrder.user.address),1)])])):Object(r["createCommentVNode"])("",!0)])]),Object(r["createVNode"])("div",_,[x,Object(r["createVNode"])("table",D,[o.tempOrder.user?(Object(r["openBlock"])(),Object(r["createBlock"])("tbody",M,[Object(r["createVNode"])("tr",null,[L,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.tempOrder.id),1)]),Object(r["createVNode"])("tr",null,[P,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(e.$filters.date(o.tempOrder.create_at)),1)]),Object(r["createVNode"])("tr",null,[T,Object(r["createVNode"])("td",null,[o.tempOrder.paid_date?(Object(r["openBlock"])(),Object(r["createBlock"])("span",E,Object(r["toDisplayString"])(e.$filters.date(o.tempOrder.paid_date)),1)):(Object(r["openBlock"])(),Object(r["createBlock"])("span",G," 時間格式錯誤 "))])]),Object(r["createVNode"])("tr",null,[F,Object(r["createVNode"])("td",{class:[o.tempOrder.is_paid?"text-success":"text-danger"]},Object(r["toDisplayString"])(o.tempOrder.is_paid?"已付款":"未付款"),3)]),Object(r["createVNode"])("tr",null,[H,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])("NT ".concat(e.$filters.currency(o.tempOrder.total))),1)])])):Object(r["createCommentVNode"])("",!0)]),I,Object(r["createVNode"])("table",q,[o.tempOrder.products?(Object(r["openBlock"])(),Object(r["createBlock"])("tbody",J,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(o.tempOrder.products,(function(t){return Object(r["openBlock"])(),Object(r["createBlock"])("tr",{key:t.id},[Object(r["createVNode"])("th",null,Object(r["toDisplayString"])(t.product.title),1),Object(r["createVNode"])("td",U,Object(r["toDisplayString"])("".concat(t.qty," / ").concat(t.product.unit)),1),Object(r["createVNode"])("td",z,Object(r["toDisplayString"])("NT ".concat(e.$filters.currency(t.final_total))),1)])})),128))])):Object(r["createCommentVNode"])("",!0)]),Object(r["createVNode"])("div",A,[Object(r["createVNode"])("div",K,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{id:"payChecked","onUpdate:modelValue":t[2]||(t[2]=function(e){return o.tempOrder.is_paid=e}),class:"form-check-input",type:"checkbox"},null,512),[[r["vModelCheckbox"],o.tempOrder.is_paid]]),Object(r["createVNode"])("label",Q,Object(r["toDisplayString"])(o.tempOrder.is_paid?"已付款":"未付款"),1)])])])])]),Object(r["createVNode"])("div",R,[Object(r["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=function(e){return n.changePayment(o.id)})}," 修改付款狀態並關閉 "),Object(r["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[4]||(t[4]=function(e){return n.closeModal("edit")})}," 取消 ")])])])],512),Object(r["createVNode"])("div",W,[Object(r["createVNode"])("div",X,[Object(r["createVNode"])("div",Y,[Object(r["createVNode"])("div",Z,[ee,Object(r["createVNode"])("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[5]||(t[5]=function(e){return n.closeModal("delete")})})]),te,Object(r["createVNode"])("div",ce,[Object(r["createVNode"])("button",{type:"button",class:"btn btn-danger",onClick:t[6]||(t[6]=function(e){return n.deleteOrder(o.id)})}," 確定刪除 "),Object(r["createVNode"])("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[7]||(t[7]=function(e){return n.closeModal("delete")})}," 取消 ")])])])],512)])}var re=c("7c2b"),oe=c.n(re),ne={data:function(){return{modal:{delete:null,edit:null},tempOrder:{},id:null,currentPage:1}},mounted:function(){this.modal.delete=new oe.a(this.$refs.adminDeleteOrderModal),this.modal.edit=new oe.a(this.$refs.adminEditOrdersModal)},methods:{clearStatus:function(){this.tempOrder={},this.id=null},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"delete",t=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;"edit"===e&&(this.tempOrder=c),this.modal[e].show(),this.id=t,this.current_page=a},closeModal:function(e){this.modal[e].hide(),this.clearStatus()},deleteOrder:function(e){var t=this;this.$emitter.emit("fullScreenLoading",!0);var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("pet","/admin/order/").concat(e);this.$http.delete(c).then((function(e){e.data.success?(t.closeModal("delete"),t.$swal(e.data.message,"","success").then((function(){t.$emit("get-orders",t.current_page)})),t.clearStatus()):t.$swal(e.data.message,"","error"),t.$emitter.emit("fullScreenLoading",!1)})).catch((function(e){t.$swal(e,"","error"),t.$emitter.emit("fullScreenLoading",!1)}))},changePayment:function(e){var t=this;this.$emitter.emit("fullScreenLoading",!0),this.$http.put("".concat("https://vue3-course-api.hexschool.io","/api/").concat("pet","/admin/order/").concat(e),{data:this.tempOrder}).then((function(e){e.data.success?(t.closeModal("edit"),t.$swal("付款狀態已修改","","success").then((function(){t.$emit("get-orders",t.current_page)}))):t.$swal(e.data.message,"","error"),t.$emitter.emit("fullScreenLoading",!1)})).catch((function(e){t.$swal(e,"","error"),t.$emitter.emit("fullScreenLoading",!1)}))}}},de=c("d959"),le=c.n(de);const ie=le()(ne,[["render",ae]]);var se=ie,be={name:"Orders",components:{Pagination:j["a"],OrdersModal:se},data:function(){return{orders:[],pagination:{category:null,current_page:null,has_next:!1,has_pre:!1,total_pages:null}}},created:function(){this.getOrders()},methods:{getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("pet","/admin/orders?page=").concat(t);this.$emitter.emit("fullScreenLoading",!0),this.$http.get(c).then((function(t){if(t.data.success){var c=t.data,a=c.orders,r=c.pagination;e.orders=a,e.pagination=r}else e.$swal(t.data.message,"","error");e.$emitter.emit("fullScreenLoading",!1)})).catch((function(t){e.$swal(t,"","error"),e.$emitter.emit("fullScreenLoading",!1)}))},changePayment:function(e){var t=this,c=this.orders.findIndex((function(t){return t.id===e}));this.orders[c].is_paid=!this.orders[c].is_paid,this.$emitter.emit("fullScreenLoading",!0),this.$http.put("".concat("https://vue3-course-api.hexschool.io","/api/").concat("pet","/admin/order/").concat(e),{data:this.orders[c]}).then((function(e){e.data.success?t.$swal("付款狀態已修改","","success").then((function(){t.getOrders()})):t.$swal(e.data.message,"","error"),t.$emitter.emit("fullScreenLoading",!1)})).catch((function(e){t.$swal(e,"","error"),t.$emitter.emit("fullScreenLoading",!1)}))},modalHandler:function(e,t){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.$refs.OrdersModal.openModal(e,t,c,this.pagination.current_page)}}};const ue=le()(be,[["render",O]]);t["default"]=ue}}]);
//# sourceMappingURL=chunk-2d20e872.e637e3ae.js.map